{"version":3,"sources":["day8/re_frame_10x/inlined_deps/spade/git_sha_93ef290/container/dom.cljs"],"mappings":";AAOA,GAAA,QAAAA,iCAAAC,8CAAAC,2DAAAC,iEAAAC,iFAAAC,2FAAAC,+FAAAC;AAAA;AAAA,AAAA,AAAmBC,iGAAkB,6CAAA,7CAACC;;AAEtC,0FAAA,1FAAOC,4LAAiBC,IAAIC;AAA5B,AACE,QAAM,AAAa,AAAA,yFAAUD,iBAAMC;;AAErC,kFAAA,lFAAMC,4KAASC,iBAAiBC,GAAGH;AAAnC,AACE,OAACI,mDAAMF,iBAAiBG,iBAAOF,GACxB,kHAA2BJ;AAA3B,AACE,GAAU,AAACO,6CAAE,AAAA,uFAASP,KAAKC;AAA3B;AAAA,AACE,AAACF,wFAAgBC,IAAIC;;;AACvB,yDAAA,lDAACO,8CAAMR,6DAAYC;;;AAE9B,kFAAA,lFAAMQ,4KAASC,WAAWP,iBAAiBC,GAAGH;AAA9C,AACE,IAAMU,UAAQ,iBAAAC,WAAM,uBAAA,vBAACC;AAAP,AAAA,AAAAD,sBAAA,WAC4B,4CAAKR;;AADjCQ;;UAAd,2CAAA,mEAAA,6DAAA,jLAEMZ,4GAAcW,iEACDV,sDACJG;AAJf,AAKE,GAAQ,GAAA,eAAA,dAAOM;AAAf;AAAA,AAAA,MAAA,KAAAI,MAAA,CAAA,kBAAA,mEAAA,KAAA;;;AAGA,AAAcJ,uBAAWC;;AAEzB,AAACN,mDAAMF,iBAAiBY,gBAAMX,GAAGJ;;AACjC,OAACD,wFAAgBC,IAAIC;;AAEzB,AAAA;;;;;;;;;AAAA,AAAA,CAAA,AAAA,iLAAAe,jLAASK;;AAAT,CAAA,AAAA,0MAAA,1MAASA,qNAEQG,EAAEC,WAAWxB;;AAF9B,AAAA,YAAA,RAEiBuB;AAFjB,AAGI,IAAME,qBAAmB,iBAAAC,mBAAIJ;AAAJ,AAAA,oBAAAI;AAAAA;;AACI9B;;;AAD7B,AAEE,GAAI,0BAAA,AAAA+B,1BAACC,0CAAWH,oBAAmBD;AACjC,OAACvB,gFAAQwB,mBAAmBD,WAAWxB;;AAEvC,IAAM6B,eAAa,iBAAAH,mBAAI,2CAAA,qIAAA,9KAAM,AAACI,qBAAKrB,oBACV,CAACA,kDAAAA,oDAAAA;AADP,AAAA,oBAAAiB;AAAAA;;AAAA,IAAAA,uBAEIjB;AAFJ,AAAA,oBAAAiB;AAAAA;;AAGI,OAAQK;;;;AAH/B,AAIE,OAACvB,gFAAQqB,aAAaJ,mBAAmBD,WAAWxB;;;;AAZ9D,CAAA,gGAAA,hGAASoB;AAAT,AAAA,AAAA;;;AAAA,CAAA,sGAAA,tGAASA;;AAAT,CAAA,yGAAA,zGAASA;;AAAT,CAAA,8GAAA,WAAAJ,mBAAAC,qBAAAC,jKAASE;AAAT,AAAA,OAAAD,iBAAAF,qBAAA;;;AAAA;;;4FAAA,5FAASI,gMAAmBZ,WAAWa;AAAvC,AAAA,YAAAF,qFAA4BX,WAAWa;;;AAA9BF,AAcT,AAAA;;;;;;;;;;sFAAA,8FAAAY,pLAAME;AAAN,AAAA,IAAAD,WAAA,AAAA;AAAA,AAAA,QAAAA;KAAA;AAAA,OAAAC;;;KAAA;AAAA,OAAAA,kHAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,kHAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;;AAAA,MAAA,KAAArB,MAAA,CAAA,8DAAA,AAAA;;;;;AAAA,CAAA,oHAAA,pHAAMqB;AAAN,AASM,yHAAA,lHAACC;;;AATP,CAAA,oHAAA,pHAAMD,+HAUFzB;AAVJ,AAUgB,OAAC0B,kHAAiB1B,WAAW,8BAAA,mDAAA,/DAAMA,YACJ,6CAAA,7CAACZ;;;AAXhD,CAAA,oHAAA,pHAAMqC,+HAYFzB,WAAWP;AAZf,AAaG,OAACmB,0FAAoBZ,WAAWP;;;AAbnC,CAAA,8GAAA,9GAAMgC;;AAAN","names":["js/day8","js/day8.re-frame-10x","js/day8.re-frame-10x.inlined-deps","js/day8.re-frame-10x.inlined-deps.spade","js/day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290","js/day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container","js/day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container.dom","js/day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container.dom.*injected-styles*","day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container.dom/*injected-styles*","cljs.core.atom","day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container.dom/perform-update!","obj","css","day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container.dom/update!","styles-container","id","cljs.core.swap_BANG_","cljs.core/update","cljs.core._EQ_","cljs.core.assoc","day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container.dom/inject!","target-dom","element","G__16815","js/document.createElement","js/Error","cljs.core/assoc","cljs.core/PROTOCOL_SENTINEL","this__5327__auto__","writer__5328__auto__","opt__5329__auto__","cljs.core/-write","day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container.dom/DomStyleContainer","day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container.dom/->DomStyleContainer","styles","_","style-name","resolved-container","or__5043__auto__","cljs.core/deref","cljs.core/contains?","resolved-dom","cljs.core/ifn?","js/document","var_args","G__16824","day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container.dom/create-container","day8.re_frame_10x.inlined_deps.spade.git_sha_93ef290.container.dom.create_container"],"sourcesContent":["(ns day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container.dom\n  \"The DomStyleContainer renders styles into DOM elements. References to those\n   elements are stored in a `styles` atom, or `*injected-styles*` if that is\n   not provided. Similarly, if no `target-dom` is provided, the `document.head`\n   element is used.\"\n  (:require [day8.re-frame-10x.inlined-deps.spade.git-sha-93ef290.container :refer [IStyleContainer]]))\n\n(defonce ^:dynamic *injected-styles* (atom nil))\n\n(defn- perform-update! [obj css]\n  (set! (.-innerHTML (:element obj)) css))\n\n(defn update! [styles-container id css]\n  (swap! styles-container update id\n         (fn update-injected-style [obj]\n           (when-not (= (:source obj) css)\n             (perform-update! obj css))\n           (assoc obj :source css))))\n\n(defn inject! [target-dom styles-container id css]\n  (let [element (doto (js/document.createElement \"style\")\n                  (.setAttribute \"spade-id\" (str id)))\n        obj {:element element\n             :source css\n             :id id}]\n    (assert (some? target-dom)\n            \"An <head> element or target DOM is required to inject the style.\")\n\n    (.appendChild target-dom element)\n\n    (swap! styles-container assoc id obj)\n    (perform-update! obj css)))\n\n(deftype DomStyleContainer [target-dom styles]\n  IStyleContainer\n  (mount-style! [_ style-name css]\n    (let [resolved-container (or styles\n                                 *injected-styles*)]\n      (if (contains? @resolved-container style-name)\n        (update! resolved-container style-name css)\n\n        (let [resolved-dom (or (when (ifn? target-dom)\n                                 (target-dom))\n                               target-dom\n                               (.-head js/document))]\n          (inject! resolved-dom resolved-container style-name css))))))\n\n(defn create-container\n  \"Create a DomStyleContainer. With no args, the default is created, which\n   renders into the `document.head` element. For rendering into a custom\n   target, such as when using Shadow DOM, you may provide a custom\n   `target-dom`: this may either be the element itself, or a function which\n   returns that element.\n\n   If you also wish to provide your own storage for the style references, you\n   may use the 3-arity version and provide an atom.\"\n  ([] (create-container nil))\n  ([target-dom] (create-container target-dom (when target-dom\n                                               (atom nil))))\n  ([target-dom styles-container]\n   (->DomStyleContainer target-dom styles-container)))\n"]}